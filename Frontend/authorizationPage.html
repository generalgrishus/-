<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Авторизация</title>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="
    https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js
    "></script>
</head>
<body>
  <p>Введите логин</p>
  <input type = "text" id= "username">
  <p>Введите пароль</p>
  <input type = "password" id = "password">
  <p></p>
  <button type="button" onclick="send()">Войти</button>

  <script>
    send = function(){
      const requestUrl = 'http://127.0.0.1:8000/api/auth/';
      const userData = {  
      username: username.value,
      password: password.value,
    }
    var cookie = Cookies.get('csrftoken');
    const config = {
        method: "POST",
        headers: new Headers({"content-type": "application/json"},{'X-CSRFToken': cookie}),
        credentials: 'include',
        body: JSON.stringify(userData)
    };
    const request = fetch(requestUrl, config
    )
    .then(response => response.json())
    .then(function (response) {
      const returnData = (response);
      jsonData = JSON.parse(returnData);
      receivedErrors = jsonData.errors;
      console.log(receivedErrors);
      if (receivedErrors != null){
        const container = document.getElementById('container');
        const answer = document.createElement('p');
        if (receivedErrors.__all__){
          answer.innerText = `${receivedErrors.__all__[0]}`
          container.appendChild(answer);
        }
        if (receivedErrors.username){
          answer.innerText = `${receivedErrors.username[0]}`
          container.appendChild(answer);
        }
        if (receivedErrors.password){
          answer.innerText = `${receivedErrors.password[0]}`
          container.appendChild(answer);
        }
      }
      else if (jsonData.success == true){
        window.location.href = 'index.html';
      }
      })
    }
  </script>
  <script>
  </script>
</body>
</html>